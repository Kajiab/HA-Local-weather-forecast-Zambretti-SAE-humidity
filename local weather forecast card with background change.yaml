type: custom:vertical-stack-in-card
card_mod:
  style: |
    ha-card {
      /* 1. ดึงตัวอักษร Zambretti (A-Z) */
      {% set t_l = state_attr('sensor.local_forecast', 'type_l') %}
      
      /* 2. กำหนดรูปพื้นหลังตามกลุ่มตัวอักษร */
      {% if t_l in ['A','B','C'] %}
        {% set bg = "sunny.jpg" %}
        {% set aura = "rgba(255, 215, 0, 0.6)" %} /* สีทอง/แดด */
      {% elif t_l in ['D','E','F','G','H','I','J','K','L','M','N','O','P'] %}
        {% set bg = "cloudy.jpg" %}
        {% set aura = "rgba(169, 169, 169, 0.5)" %} /* สีเทา/เมฆ */
      {% else %}
        {% set bg = "rainy.jpg" %}
        {% set aura = "rgba(0, 191, 255, 0.7)" %} /* สีฟ้าเข้ม/ฝน */
      {% endif %}

      /* 3. สไตล์พื้นหลัง */
      background-image: url("/local/weather/{{ bg }}") !important;
      background-size: cover !important;
      background-position: center !important;
      transition: all 0.5s ease;
      
      /* 4. การทำ Aura แวบๆ (Glow Animation) */
      box-shadow: 0 0 15px 5px {{ aura }} !important;
      animation: aura-pulse 3s infinite alternate;
    }

    /* 5. Definition ของ Animation */
    @keyframes aura-pulse {
      0% { box-shadow: 0 0 5px 2px {{ aura }}; }
      100% { box-shadow: 0 0 25px 10px {{ aura }}; }
    }

    /* ปรับตัวอักษรให้อ่านง่ายบนพื้นหลัง */
    ha-card * {
      --primary-text-color: white;
      --secondary-text-color: #e0e0e0;
      text-shadow: 1px 1px 3px rgba(0,0,0,0.8);
    }
